<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hóa Đơn Photo</title>
    <link rel="stylesheet" href="style.css">
    <!-- Thêm Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="invoice-container">
        <h1>Hóa Đơn Photo</h1>
        <p class="invoice-date"><em>Thời gian tạo hóa đơn: <span id="invoiceDate"></span></em></p>
        <p><i class="fas fa-user"></i> Tên khách hàng: <span id="customerName"></span></p>
        <p><i class="fas fa-building"></i> Địa chỉ khách hàng: <span id="customerClass"></span></p>
        <p><i class="fas fa-file-alt"></i> Tên file: <span id="fileName"></span></p>
        <p><i class="fas fa-file-pdf"></i> Số trang: <span id="pages"></span></p>
        <p><i class="fas fa-print"></i> Kiểu in: <span id="printType"></span></p>
        <hr>
        <p><i class="fas fa-dollar-sign"></i> Số tiền gốc: <span id="totalPriceBeforeDiscount"></span> VND</p>
        <p><i class="fas fa-percent"></i> Giảm giá: <span id="discountAmount"></span> VND</p>
        <p><i class="fas fa-tag"></i> <strong>Tổng số tiền: <span id="finalTotalPrice"></span> VND</strong></p>
        <p><i class="fas fa-calendar-check"></i> <strong>Dự kiến ngày nhận hàng:</strong> <span id="estimatedDeliveryDate"></span></p>
        <p class="note"><em>Hãy gửi file để in trước 16:30 hàng ngày để nhận tài liệu trong ngày mai. (Nếu gửi sau thì tài liệu in ra có thể lâu hơn dự tính). Không làm việc vào Chủ Nhật. Xin cảm ơn!</em></p>

        <!-- Thêm mã QR và thông tin bên cạnh -->
        <div class="qr-and-info">
            <div class="qr-container">
                <p><strong>Thanh toán qua mã QR:</strong></p>
                <img src="qr-banking.png" alt="QR Code" class="qr-code">
            </div>
            <div class="info-container">
                <p><strong><i class="fas fa-user-circle"></i> Chủ tài khoản:</strong> DO MANH HUNG</p>
                <p><strong><i class="fas fa-credit-card"></i> Số tài khoản:</strong> 118072207</p>
                <p><strong><i class="fas fa-university"></i> Ngân hàng:</strong> MB Bank</p>
                <p><strong><i class="fas fa-dollar-sign"></i> Số tiền:</strong> <span id="finalAmount"></span> VND</p>
                <p><strong><i class="fas fa-file-alt"></i> Nội dung:</strong> <span id="paymentContent"></span></p>
            </div>
        </div>

        <p class="thank-you">Xin cảm ơn quý khách!</p>
        
        <div style="text-align: center; margin-top: 30px; padding-bottom: 10px;">
            <a href="index.html" class="button-link-back">
                <i class="fas fa-calculator"></i> Quay lại trang tính tiền
            </a>
        </div>
    </div>

    <script>
        const invoiceData = JSON.parse(localStorage.getItem('invoiceData'));
        if (invoiceData) {
            // ... (điền các thông tin khác như customerName, pages, v.v.) ...

            // HIỂN THỊ NGÀY TẠO HÓA ĐƠN TỪ DỮ LIỆU ĐÃ LƯU (serverCreatedAt)
            if (invoiceData.serverCreatedAt) {
                const orderCreationDate = new Date(invoiceData.serverCreatedAt); // serverCreatedAt nên là chuỗi ISO Date
                if (!isNaN(orderCreationDate.getTime())) {
                    document.getElementById('invoiceDate').textContent = orderCreationDate.toLocaleDateString('vi-VN', {
                        day: '2-digit', month: '2-digit', year: 'numeric'
                        // Bạn có thể thêm options cho giờ, phút nếu muốn:
                        // hour: '2-digit', minute: '2-digit' 
                    });
                } else {
                    // Fallback nếu serverCreatedAt không parse được, thử dùng createdAt cũ từ client nếu có
                    const clientOrderCreationDate = invoiceData.createdAt ? new Date(invoiceData.createdAt) : null;
                    if (clientOrderCreationDate && !isNaN(clientOrderCreationDate.getTime())) {
                         document.getElementById('invoiceDate').textContent = clientOrderCreationDate.toLocaleDateString('vi-VN', {
                            day: '2-digit', month: '2-digit', year: 'numeric'
                        });
                    } else {
                        document.getElementById('invoiceDate').textContent = "Không rõ ngày tạo";
                    }
                }
            } else {
                // Fallback nếu không có serverCreatedAt (trường hợp dữ liệu cũ)
                 const clientOrderCreationDate = invoiceData.createdAt ? new Date(invoiceData.createdAt) : null;
                 if (clientOrderCreationDate && !isNaN(clientOrderCreationDate.getTime())) {
                         document.getElementById('invoiceDate').textContent = clientOrderCreationDate.toLocaleDateString('vi-VN', {
                            day: '2-digit', month: '2-digit', year: 'numeric'
                        });
                    } else {
                        document.getElementById('invoiceDate').textContent = "Không rõ ngày tạo (cũ)";
                    }
            }

            // ... (điền các thông tin còn lại như finalTotalPrice, ...)
            document.getElementById('customerName').textContent = invoiceData.customerName || 'Không có';
            document.getElementById('customerClass').textContent = invoiceData.customerClass || 'Không có';
            document.getElementById('fileName').textContent = invoiceData.fileName || 'Không có';
            document.getElementById('pages').textContent = invoiceData.pages || '0';
            document.getElementById('printType').textContent = invoiceData.printType === 'portrait' ? 'Dọc' : 'Ngang';
            document.getElementById('totalPriceBeforeDiscount').textContent = invoiceData.totalPriceBeforeDiscount ? invoiceData.totalPriceBeforeDiscount.toLocaleString('vi-VN') : '0';
            // Giả sử discountAmount là tổng của friendDiscountAmount và programDiscountAmount
            const totalDiscount = (invoiceData.friendDiscountAmount || 0) + (invoiceData.programDiscountAmount || 0);
            document.getElementById('discountAmount').textContent = totalDiscount.toLocaleString('vi-VN');
            document.getElementById('finalTotalPrice').textContent = invoiceData.finalTotalPrice ? invoiceData.finalTotalPrice.toLocaleString('vi-VN') : '0';
            document.getElementById('estimatedDeliveryDate').textContent = `${invoiceData.estimatedStartDate} - ${invoiceData.estimatedEndDate}`;
            document.getElementById('finalAmount').textContent = invoiceData.finalTotalPrice ? invoiceData.finalTotalPrice.toLocaleString('vi-VN') : '0';
            document.getElementById('paymentContent').textContent = `${invoiceData.customerName} thanh toan hoa don photo`;


        } else {
            document.body.innerHTML = '<h2>Không có dữ liệu hóa đơn!</h2>';
        }
    </script>
</body>
</html>

<script>
function createStars(numberOfStars) {
    const body = document.body;
    for (let i = 0; i < numberOfStars; i++) {
        let star = document.createElement('div');
        star.classList.add('star');

        // Kích thước và animation ngẫu nhiên
        let size = Math.floor(Math.random() * 3) + 1; // 1 đến 3px
        star.classList.add('s' + size);
        star.style.animationDuration = (Math.random() * 3 + 2) + 's'; // 2 đến 5s
        star.style.animationDelay = Math.random() * 3 + 's';     // delay ngẫu nhiên

        // Vị trí ngẫu nhiên
        star.style.top = Math.random() * 100 + '%';
        star.style.left = Math.random() * 100 + '%';

        body.appendChild(star);
    }
}
// Gọi hàm khi DOM đã tải xong
document.addEventListener('DOMContentLoaded', function() {
    createStars(100); // Tạo 100 ngôi sao
});
</script>
